---
layout: post
title: 每天一个Linux命令(10)：cp  
description: 命令cp的讲解  
tag: Linux
---

* 命令格式：`cp [OPTION]... [-T] SOURCE DEST`  or:  `cp [OPTION]... SOURCE... DIRECTORY`  or:  `cp [OPTION]... -t DIRECTORY SOURCE...`  

* 命令功能：  
   
   copy的缩写，可以将一个文件或目录从一个位置复制到另一个位置。  
   
   **注：cp是一个具有破坏性的命令，如果使用不当，可能会导致灾难性的后果。**  

* 常用参数：  

|选项|全称|说明|
|:--:|:--:|:--:|
|-a|--archive                |等于 -dR --preserve=all|
|-|   --backup[=CONTROL]      |为每个已存在的目标文件创建备份|
|-b|-                         |类似--backup，但不接受参数|
|-|  --copy-contents          |在递归处理复制特殊文件内容|
|-d|-                         |类似于 --no-dereference --preserve=links|
|**-f**|--force                  |如果目标文件无法打开则将其移除并重试（-n选项存在时不需要再选此项|
|**-i**|--interactive            |覆盖前询问（使前面的-n选项失效|
|-H|-                        |跟随源文件中的命令行符号链接|
|-l|--link                   |链接文件而不复制|
|-L|--dereference            |总是跟随符号链接|
|-n|--no-clobber             |不覆盖已存在的文件（使前面的-i选项失效|
|-P|--no-dereference         |不跟随源文件中的符号链接|
|**-p**|-                        |等于 --preserve=mode,ownership, timestamps|
|-|--preserve[=ATTR_LIST]   |保持指定的属性（默认：mode, ownership, timestamps; 如果可能保持附加属性： context, links, xattr,|
|-R, **-r**|--recursive          |递归的复制目录及目录内的所有项目|

**注：其中-i, -f, -r, -p四个选项最为常见。**  

* 实例：  

显示当前路径下以c开头的文件：  

```
[nora@localhost ~]$ ls -l c*
-rw-rw-r--. 1 nora nora 2018 Nov  5 11:14 cal2012
```

复制文件：  

```
[nora@localhost ~]$ cp cal2012 cal2038
```

查看复制之后目录下的文件：  

```
[nora@localhost ~]$ ls -l c*
-rw-rw-r--. 1 nora nora 2018 Nov  5 11:14 cal2012
-rw-rw-r--. 1 nora nora 2018 Nov  5 16:08 cal2038
```

复制时保留时间戳属性：  

```
[nora@localhost ~]$ cp -p cal2012 cal2039
[nora@localhost ~]$ ls  -l c*
-rw-rw-r--. 1 nora nora 2018 Nov  5 11:14 cal2012
-rw-rw-r--. 1 nora nora 2018 Nov  5 16:08 cal2038
-rw-rw-r--. 1 nora nora 2018 Nov  5 11:14 cal2039
```

当复制的新文件的文件名已存在时，它并不会有任何提示：  

```
[nora@localhost ~]$ cp lists cal2038
[nora@localhost ~]$ ls -l c* l*
-rw-rw-r--. 1 nora nora 2018 Nov  5 11:14 cal2012
-rw-rw-r--. 1 nora nora 1311 Nov  5 16:10 cal2038
-rw-rw-r--. 1 nora nora 2018 Nov  5 11:14 cal2039
-rw-rw-r--. 1 nora nora 1311 Nov  5 11:14 lists
```

当不确定要生成的目的文件是否存在时，可以使用-i选项的cp命令进行复制：  

```
[nora@localhost ~]$ cp -i lists cal2039
cp: overwrite ‘cal2039’? n
[nora@localhost ~]$ ls -l c*
-rw-rw-r--. 1 nora nora 2018 Nov  5 11:14 cal2012
-rw-rw-r--. 1 nora nora 1311 Nov  5 16:10 cal2038
-rw-rw-r--. 1 nora nora 2018 Nov  5 11:14 cal2039
```

也可将多个文件复制到一个指定的目录下：  

```
[nora@localhost ~]$ ls -l haha
total 0
[nora@localhost ~]$ cp lists cal2012 haha
[nora@localhost ~]$ ls -l haha
total 8
-rw-rw-r--. 1 nora nora 2018 Nov  5 16:13 cal2012
-rw-rw-r--. 1 nora nora 1311 Nov  5 16:13 lists
```

可以使用通配符“*”一次复制多个文件：  

```
[nora@localhost ~]$ cp cal* haha
[nora@localhost ~]$ ls -l haha
total 16
-rw-rw-r--. 1 nora nora 2018 Nov  5 16:14 cal2012
-rw-rw-r--. 1 nora nora 1311 Nov  5 16:14 cal2038
-rw-rw-r--. 1 nora nora 2018 Nov  5 16:14 cal2039
-rw-rw-r--. 1 nora nora 1311 Nov  5 16:13 lists
```

直接复制一个目录到另一个目录会显示略过：  

```
[nora@localhost ~]$ cp haha hei
cp: omitting directory ‘haha’
```

要复制目录需要在cp命令中加入-r选项：  

```
[root@localhost nora]# cp -r ./haha ./hei
[root@localhost nora]# ls -l ./hei
总用量 0
drwxr-xr-x. 2 root root 64 11月  5 16:53 haha
[root@localhost nora]# ls -l ./hei/haha
总用量 16
-rw-r--r--. 1 root root 2018 11月  5 16:53 cal2012
-rw-r--r--. 1 root root 1311 11月  5 16:53 cal2038
-rw-r--r--. 1 root root 2018 11月  5 16:53 cal2039
-rw-r--r--. 1 root root 1311 11月  5 16:53 lists
```

**注：复制时需要以root权限，否则无法复制整个目录。**  

**-a选项可使复制时保留原有的日期和时间。作用和-p类似。**  

参考文献：  

https://www.cnblogs.com/peida/archive/2012/10/29/2744185.html

转载请注明：[南梦婷的博客](https://norah2.github.io) » [点击阅读原文](https://norah2.github.io/2019/11/Linux10/)   

<!--以下是本文用到的链接-->  
